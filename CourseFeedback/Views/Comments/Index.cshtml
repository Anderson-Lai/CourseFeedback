@using CourseFeedback.Areas.Identity.Data
@using Microsoft.AspNetCore.Identity
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

@model Comments
@inject UserManager<ApplicationUser> userManager

@{
    var user = await userManager.FindByIdAsync(Model.UserId);

    ViewBag.User = user;
    ViewBag.ControllerUser = "FirstComments";
    ViewBag.RerouteToController = "Courses";
    ViewBag.Model = Model;
    ViewBag.IsCommentOrReply = "Comment";
}

<div class="d-flex flex-column">
    <partial name="~/Views/_DisplayReplies.cshtml" />

    @{
        ViewBag.RerouteToController = "Comments";
        ViewBag.ControllerUser = "Comments";
        ViewBag.IsCommentOrReply = "Reply";
    }

    @foreach(var reply in Model.Replies)
    {
        var replyUser = await userManager.FindByIdAsync(reply.UserId);

        ViewBag.User = replyUser;
        ViewBag.Model = reply;

        <partial name="~/Views/_DisplayReplies.cshtml" />
    }
</div>
